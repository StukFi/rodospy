{% extends 'layout.jinja2' %}

{% block subtitle %}Item's - {% endblock subtitle %}

{% block content %}

<p><a href="{{request.route_url('scenario', id=scenario.id)}}">Scenario {{ scenario.id|safe }}</a> - {{ scenario.name|safe }}</p>
<p><a href="{{request.route_url('item', id=item.id|safe) }}">Item {{ item.id|safe }}</a>- {{ item.name|safe }} </p>

{% if edit %}

    <p>Editing <strong>{{item.name}}</strong>, created by <strong>{{item.creator.name}}</strong></p>
    <form action="{{ save_url }}" method="post">
        <div class="form-group">
            <button type="submit" name="form.submitted" value="Save-Item" class="btn btn-default">Save</button>
            <button type="submit" name="form.submitted" value="Save-Item-GoTo-Scenario" class="btn btn-default">Save - Show Scenario</button>
            <button type="submit" name="form.submitted" value="Cancel-Edit-GoTo-Scenario" class="btn btn-default">Cancel Edit</button>
        </div>
        <div class="form-group">
            {# adding editor id activates the ckeditor machinery #}
            <textarea id="editor" class="form-control" name="body" rows="10" cols="60">{{ item.data }}</textarea>
        </div>
    </form>
    <!-- https://ckeditor.com/ckeditor-5/ -->
    <script src="https://cdn.ckeditor.com/ckeditor5/16.0.0/classic/ckeditor.js"></script>
    <script>
      ClassicEditor
        .create( document.querySelector( '#editor' ), {
          removePlugins:['MediaEmbed', 'ImageUpload']
        })
        .catch( error => {
            console.error( error );
        } );
    </script>

{% else %}
    <div>{{ item.data|safe }}</div>
    <p><a href="{{request.route_url('item_edit', id=item.id|safe) }}">Edit this item</a></p>
{% endif %}

<p>You can return to the
<a href="{{request.route_url('scenarios', pagename='Scenario List')}}">Scenario list</a>.
</p>

{% endblock content %}